# ููุฎุต ุฅููุงู ุงููุธุงู - ุณุญูุจุงุช ุงููุดุฑูุน ูุงูุญุณุงุจุงุช ุงูุฏูููุฉ

## โ ุงููุชุทูุจุงุช ุงูููุฌุฒุฉ

### 1. ุชูุญูุฏ ุงูุจูุงูุงุช ุจูู ุงูุตูุญุชูู
- **ุชู ุฅุตูุงุญ** ูุดููุฉ ุงูุชูุงูุถ ูู ุญุณุงุจุงุช ุงูุฏุงุดุจูุฑุฏ
- **ุชู ุชูุญูุฏ** ูุตุฏุฑ ุงูุจูุงูุงุช: ุฌููุน ุงูุตูุญุงุช ุชุณุชุฎุฏู `getDashboardStats` ูู `databaseService`
- **ุชู ุงูุชุฃูุฏ** ูู ุนุฑุถ ููุณ ุงูุจูุงูุงุช ูู ุตูุญุฉ ุงูุฑุฆูุณูุฉ ูุตูุญุฉ ุงููุณุชุซูุฑูู

### 2. ุชุทุจูู ุงููุนุงุฏูุงุช ุงูุตุญูุญุฉ
โ **ุตุงูู ุงูุฑุจุญ = ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช - ุฅุฌูุงูู ุงููุตุงุฑูู**
```typescript
const totalProfit = totalRevenue - totalExpenses;
```

โ **ุงูุฑุตูุฏ ุงููุชุงุญ ููุชูุฒูุน = ุตุงูู ุงูุฑุจุญ - ูุณุจุฉ ุงููุดุฑูุน - ุฅุฌูุงูู ุงูุณุญูุจุงุช**
```typescript
const availableBalance = totalProfit - projectBalance - customAllocationsAmount - projectWithdrawals - totalWithdrawals;
```

โ **ุฑุตูุฏ ูู ูุณุชุซูุฑ = ูุณุจุชู ูู ุงูุฑุตูุฏ ุงููุชุงุญ ููุชูุฒูุน**
```typescript
const expectedEffectiveProfit = (stats.availableBalance * effectiveSharePercentage) / 100;
```

### 3. ูุธุงู ุณุญูุจุงุช ุงููุดุฑูุน ุงูููุชูู

#### ูุงุนุฏุฉ ุงูุจูุงูุงุช:
- โ **ุฌุฏูู `project_withdrawals`** ูู SQLite ู Supabase
- โ **ุฏูุงู CRUD ูุงููุฉ** ูู ููุง ูุงุนุฏุชู ุงูุจูุงูุงุช
- โ **ุญุณุงุจุงุช ุงูุณุญูุจุงุช** ูุฏูุฌุฉ ูู ุงููุนุงุฏูุงุช ุงูุฑุฆูุณูุฉ

#### ุงูุฎุงุฏู (Backend):
- โ **API endpoints** ูุงููุฉ:
  - `GET /api/project-withdrawals` - ุฌูุจ ุงูุณุญูุจุงุช
  - `POST /api/project-withdrawals` - ุฅุถุงูุฉ ุณุญุจ
  - `PUT /api/project-withdrawals` - ุชุนุฏูู ุณุญุจ
  - `DELETE /api/project-withdrawals` - ุญุฐู ุณุญุจ
- โ **ุตูุงุญูุงุช ุขููุฉ**: ููุท ุงูู Admin ููููู ุฅุฏุงุฑุฉ ุณุญูุจุงุช ุงููุดุฑูุน
- โ **ุชุณุฌูู ุงูุนูููุงุช**: ุฌููุน ุงูุนูููุงุช ุชูุณุฌู ูู ุณุฌู ุงูุนูููุงุช

#### ุงููุงุฌูุฉ (Frontend):
- โ **ุตูุญุฉ ุฅุฏุงุฑุฉ ุณุญูุจุงุช ุงููุดุฑูุน** `/project-withdrawals`
- โ **ุนูููุงุช CRUD ูุงููุฉ** ูุน ูุงุฌูุฉ ูุณุชุฎุฏู ุฌูููุฉ
- โ **ุงูุชุญูู ูู ุงูุฑุตูุฏ**: ูุง ููุณูุญ ุจุณุญุจ ุฃูุซุฑ ูู ุงูุฑุตูุฏ ุงููุชุงุญ
- โ **ุฑูุงุจุท ุณุฑูุนุฉ** ูู ุงูุฏุงุดุจูุฑุฏ ูุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ

### 4. ุฏูุฉ ุงูุนูููุงุช ุงูุญุณุงุจูุฉ

#### ุงููุฑุงุฌุนุฉ ูุงูุฅุตูุงุญ:
- โ **ุฅุตูุงุญ ุงูุชูุงูุถุงุช** ุจูู ูููุงุช ุงูุฏุงุดุจูุฑุฏ ูุงููุณุชุซูุฑูู
- โ **ุชูุถูุญ ุงููุตุทูุญุงุช**: ุชูููุฒ ูุงุถุญ ุจูู ุณุญูุจุงุช ุงููุณุชุซูุฑูู ูุณุญูุจุงุช ุงููุดุฑูุน
- โ **ุฅุถุงูุฉ ุชุนูููุงุช ุชูุถูุญูุฉ** ูููุนุงุฏูุงุช ุงููุนูุฏุฉ
- โ **ุฅุตูุงุญ ุงูุนุฑุถ ุงูููุฑุฑ** ูู ุตูุญุฉ ุงููุณุชุซูุฑูู

#### ุงูุญุณุงุจุงุช ุงููุญุฏุซุฉ:
```typescript
// STEP 1: ุงูุญุณุงุจุงุช ุงูุฃุณุงุณูุฉ
totalProfit = totalRevenue - totalExpenses

// STEP 2: ุญุณุงุจ ุงูุชุฎุตูุตุงุช  
projectBalance = totalProfit ร 15%
customAllocationsAmount = totalProfit ร customAllocations%

// STEP 3: ุญุณุงุจ ุงูุณุญูุจุงุช
projectWithdrawals = sum(all project withdrawals)
totalWithdrawals = sum(all investor withdrawals)

// STEP 4: ุงูุฑุตูุฏ ุงููุชุงุญ ููุชูุฒูุน
availableBalance = totalProfit - projectBalance - customAllocationsAmount - projectWithdrawals - totalWithdrawals

// STEP 5: ุฑุตูุฏ ูู ูุณุชุซูุฑ
investorBalance = (availableBalance ร investor.effectiveSharePercentage) / 100
```

## ๐ ุงููููุงุช ุงููุญุฏุซุฉ

### Backend:
1. `server/services/databaseService.ts` - ุงูุญุณุงุจุงุช ุงูุฑุฆูุณูุฉ
2. `server/services/sqliteDatabase.ts` - ุฌุฏูู ูุฏูุงู SQLite
3. `server/services/supabaseDatabase.ts` - ุฌุฏูู ูุฏูุงู Supabase
4. `server/routes/data.ts` - routes ุงูุจูุงูุงุช
5. `server/routes/crud.ts` - ุฏูุงู CRUD ูุณุญูุจุงุช ุงููุดุฑูุน
6. `server/index.ts` - ุฅุถุงูุฉ API endpoints

### Frontend:
1. `client/pages/Dashboard.tsx` - ุฅุตูุงุญ ุงูุญุณุงุจุงุช ูุงูุฑูุงุจุท
2. `client/pages/Investors.tsx` - ุชูุญูุฏ ุงูุจูุงูุงุช ูุฅุตูุงุญ ุงูุนุฑุถ
3. `client/pages/ProjectWithdrawals.tsx` - ุตูุญุฉ ุฌุฏูุฏุฉ ูุงููุฉ
4. `client/App.tsx` - ุฅุถุงูุฉ routing
5. `client/components/DrawerMenu.tsx` - ุฅุถุงูุฉ ุฑุงุจุท ุงููุงุฆูุฉ

### Types & SQL:
1. `shared/types.ts` - ุชู ุชุนุฑูู `ProjectWithdrawal` ูุณุจูุงู
2. `PROJECT_WITHDRAWALS_TABLE.sql` - SQL script ููุฌุฏูู ุงูุฌุฏูุฏ

## ๐ฏ ุงููุชุงุฆุฌ

### โ ุงููุชุทูุจ ุงูุฃูู: ุชุทุงุจู ุงูุจูุงูุงุช
- ุฌููุน ุงูุตูุญุงุช ุชุนุฑุถ ููุณ ุงูุจูุงูุงุช ุงููุงููุฉ
- ูุตุฏุฑ ูุงุญุฏ ููุญูููุฉ: `getDashboardStats`

### โ ุงููุชุทูุจ ุงูุซุงูู: ุงููุนุงุฏูุงุช ุงูุตุญูุญุฉ
- ุตุงูู ุงูุฑุจุญ = ุงูุฅูุฑุงุฏุงุช - ุงููุตุงุฑูู โ
- ุงูุฑุตูุฏ ุงููุชุงุญ = ุตุงูู ุงูุฑุจุญ - ูุณุจุฉ ุงููุดุฑูุน - ุงูุณุญูุจุงุช โ
- ุฑุตูุฏ ุงููุณุชุซูุฑ = ูุณุจุชู ร ุงูุฑุตูุฏ ุงููุชุงุญ โ

### โ ุงููุชุทูุจ ุงูุซุงูุซ: ุณุญูุจุงุช ุงููุดุฑูุน
- ูุธุงู ุฅุฏุงุฑุฉ ูุงูู ููุชูุงูู โ
- ูุงุฌูุฉ ูุณุชุฎุฏู ุณููุฉ ุงูุงุณุชุฎุฏุงู โ
- ุฃูุงู ูุตูุงุญูุงุช ูุญููุฉ โ

### โ ุงููุชุทูุจ ุงูุฑุงุจุน: ุฏูุฉ ุงูุญุณุงุจุงุช
- ูุฑุงุฌุนุฉ ุดุงููุฉ ูููุธุงู โ
- ุฅุตูุงุญ ุฌููุน ุงูุชูุงูุถุงุช โ
- ุชุนูููุงุช ุชูุถูุญูุฉ ูููุนุงุฏูุงุช โ

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุงุฎุชุจุงุฑ ุงููุธุงู** ูู ุงูุจูุฆุฉ ุงูุชุทููุฑูุฉ
2. **ุฅูุดุงุก ุฌุฏูู `project_withdrawals`** ูู Supabase ุจุงุณุชุฎุฏุงู ุงูู SQL ุงููุฑูู
3. **ุงูุชุฃูุฏ ูู ุงูุฃุฐููุงุช** ูู Supabase ุฅุฐุง ูุฒู ุงูุฃูุฑ
4. **ุงูุชุฏุฑูุจ** ุนูู ุงุณุชุฎุฏุงู ููุฒุฉ ุณุญูุจุงุช ุงููุดุฑูุน ุงูุฌุฏูุฏุฉ

## ๐ ููุงุญุธุงุช ูููุฉ

- ุงููุธุงู ูุฏุนู ุงูุขู **ุณุญูุจุงุช ุงููุดุฑูุน** ุจุดูู ูููุตู ุนู ุณุญูุจุงุช ุงููุณุชุซูุฑูู
- ุฌููุน ุงูุนูููุงุช **ูุญููุธุฉ ูู ุณุฌู ุงูุนูููุงุช** ูููุฑุงุฌุนุฉ
- ุงููุณุจ ูุงูุญุณุงุจุงุช **ุฏูููุฉ ููุชุณูุฉ** ุนุจุฑ ุฌููุน ุงูุตูุญุงุช
- ุงููุงุฌูุงุช **ุณููุฉ ุงูุงุณุชุฎุฏุงู** ููุชูุงููุฉ ูุน ุงูุชุตููู ุงูุญุงูู

ุชู ุฅูุฌุงุฒ ุฌููุน ุงููุชุทูุจุงุช ุจูุฌุงุญ! ๐
